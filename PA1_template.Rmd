---
title: "Reproducible Research: Peer Assessment 1"
author: "JCFrench"
date: "4/6/2015"
output: html_document
---

### Required R Packages
dplyr 0.4.1

ggplot2 1.0.1

```{r}
library(dplyr)
library(ggplot2)
library(lubridate)
```

## Loading and preprocessing the data
1. Set the working directory path
2. Download the compressed activity data
3. Decompress the data
4. Load the data into a dplyr tbl_df
5. Sumarize the raw data

Based on the summary, we can see that there are 3 fields in this data set; steps, date, interval. These fields are described in the course assignment.  

On cursory review, 2304 records (13%) are missing steps (NA). 

```{r}
setwd("~/RepData/data")
download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", 
              "~/RepData/data/repdata+data+activity.zip", method="curl", 
              quiet = FALSE, mode = "wb"
              )
unzip("repdata+data+activity.zip")
activity <- tbl_df(read.csv("~/RepData/data/activity.csv"))
summary(activity)

```

## What is mean total number of steps taken per day?
Here, we use the dplyr package to quickly group activities by date, and then tally the steps per day. The "step per day" calculation is acheived via a dplyr pipeline construct: group activity records by date, summarise steps via sum, ignoring "NA" values.  

Next, plot the sum of steps per day in a historgram.  

Lastly, calculate the mean steps per day, and the median steps per day.  

```{r}

stepperday <- activity %>% group_by(date) %>% summarise(stepsum = sum(steps, na.rm = TRUE))

qplot(date, data=stepperday, weight=stepsum, geom="histogram")

meanstepperday <- mean(stepperday$stepsum)
medianstepperday <- median(stepperday$stepsum)

```

## What is the average daily activity pattern?


```{r}
###ggplot(data=activity) + geom_line(aes(interval, steps, group = date, color = date)) + 
  
###ggplot(data=activity) + geom_line(aes(interval, mean(steps, na.rm=T), group = interval))

meandaily <- activity %>% group_by(interval) %>% 
                          summarise(stepmean = mean(steps, na.rm = TRUE))

qplot(interval, stepmean, data=meandaily, geom="line")

maxdaily <- meandaily %>% filter(stepmean == max(meandaily$stepmean))
maxdaily

```

## Imputing missing values
```{r}
naactivity <- activity %>% filter(is.na(steps))
impactivity <- inner_join(naactivity,meandaily,by=c("interval" = "interval"))

### impute missing values as the average observed steps within the interval
imputedactivity <- activity %>% 
                   group_by(interval) %>%
                   mutate(steps= replace(steps, is.na(steps), mean(steps, na.rm=TRUE)))
                   
imputedstepperday <- activity %>% group_by(date) %>% summarise(stepsum = sum(steps, na.rm = TRUE))

### explore the imputed results
qplot(date, data=imputedstepperday, weight=stepsum, geom="histogram")

meanimputedstepperday <- mean(imputedstepperday$stepsum)
medianimputedstepperday <- median(imputedstepperday$stepsum)

```
## Are there differences in activity patterns between weekdays and weekends?

By filtering the imputed activity into weekend vs. weekday subsets, we can see that activity across a weekend day is generally higher then the activity across a working week day.  

According the lubridate package functionality, Sundays are coded as wday == 1, while Saturdays are coded as wday == 7.  

Split the imputed activities, seperating weekend days from work week days.  

Next, create daily average activity patterns for work days vs. weekends.  

Finally, provide a comparison plot.

```{r}
wendactivity <- imputedactivity %>% filter(wday(ymd(date)) %in% c(1,7))
wdayactivity <- imputedactivity %>% filter(! wday(ymd(date)) %in% c(1,7))

wenddaily <- wendactivity %>% 
  group_by(interval) %>% 
  summarise(stepmean = mean(steps))

wdaydaily <- wdayactivity %>% 
  group_by(interval) %>% 
  summarise(stepmean = mean(steps))

qplot(interval, stepmean, data=wdaydaily, geom="line")
qplot(interval, stepmean, data=wenddaily, geom="line")

```

